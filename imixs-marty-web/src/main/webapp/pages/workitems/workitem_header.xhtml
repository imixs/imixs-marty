<f:subview xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich" id="workitem_header_id">

	<h2>
		<h:outputText value="#{workitemMB.workitem.item['txtprojectname']}: " />
		<h:outputText value="#{workitemMB.workitem.item['txtworkflowgroup']}" />
	</h2>

	<!-- Workitem Info Header -->
	<a4j:outputPanel styleClass="sywapp-viewentry" id="issue_header_id"
		layout="block" style="">


		<!-- background:#ECF3F8;border-top:1px solid #58AAD5;border-bottom:none;color:#404047; -->
		<!-- *** Sequence Number *** 
				<a4j:outputPanel layout="block"  rendered="#{!empty workitemMB.workitem.item['txtsubject']}"
					style="float:left;height:34px;border-right:1px solid silver;margin-right:5px;margin-left:2px;margin-bottom:0px;">
					<h:outputText value="#{workitemMB.workitem.item['numSequenceNumber']}"
						style="font-size:24px;font-weight:bold;margin-right:5px;" />
				</a4j:outputPanel>
				-->

		<!-- *** Image *** -->
		<a4j:outputPanel layout="block"
			rendered="#{!empty workitemMB.workitem.item['txtWorkflowImageURL']}"
			style="float:left;height:48px;margin-right:2px;margin-left:2px;margin-bottom:0px;">
			<img src="#{workitemMB.workitem.item['txtWorkflowImageURL']}"
				style="max-height: 24px; margin: 4px;" />
		</a4j:outputPanel>


		<!-- *** Standard Info *** -->
		<a4j:outputPanel layout="block" style="">
			<h:outputText style="font-size:14px; font-weight:bold;"
				rendered="#{empty workitemMB.workitem.item['txtWorkflowSummary']}"
				value="#{workitemMB.workitem.item['txtWorkflowStatus']}" />

			<h:outputText style="font-size:14px; font-weight:bold;"
				rendered="#{!empty workitemMB.workitem.item['txtWorkflowSummary']}"
				value="#{workitemMB.workitem.item['txtWorkflowSummary']}" />
			<br />

			<h:outputText style="font-weight: bold;" value="#{global.status}:" />

			<h:outputText style=""
				value=" #{workitemMB.workitem.item['txtworkflowstatus']}" />


			<a4j:commandLink rendered="#{! workitemMB.newWorkitem}"
				value="[#{messages.history}]"
				style="margin-left:10px;" reRender="infoBlock2"
				actionListener="#{workitemMB.doToggleHistory}">
			</a4j:commandLink>
			
			
			<rich:toggleControl for="suggest_process_id">
			              <h:outputText style="margin-left:10px;" value="[#{messages.progress}]" />
			</rich:toggleControl>


		</a4j:outputPanel>


<!-- Process View -->
			<rich:togglePanel switchType="client" id="suggest_process_id"
				stateOrder="processview_closed,processview_open">
				<f:facet name="processview_closed">
					<a4j:outputPanel><!-- closed --></a4j:outputPanel>
				</f:facet>
							
				<f:facet name="processview_open">
				<!-- open -->
				<a4j:outputPanel layout="block" 
				styleClass="sywapp-viewentry-details"
				 style="border-top: 1px solid silver;">
				<ui:include src="/pages/workitems/processmap.xhtml" />
				</a4j:outputPanel>
				</f:facet>
			</rich:togglePanel>
	


<!-- History View -->
		<a4j:outputPanel id="infoBlock2" layout="block"
			styleClass="sywapp-viewentry-details">

			<a4j:outputPanel layout="block" style="border-top: 1px solid silver;"
				rendered="#{workitemMB.workitem.item['a4j:showHistory']}">
				<h:outputText value="#{global.created}: " />
				<h:outputText value="#{workitemMB.workitem.item['$created']}">
					<f:convertDateTime type="both" dateStyle="medium" />
				</h:outputText>
				<h:outputText
					value=" #{global.by} #{nameLookupMB.userName[workitemMB.workitem.item['namCreator']]}" />

				<br />
				<h:outputText value="#{global.modified}: " />
				<h:outputText value="#{workitemMB.workitem.item['$modified']}">
					<f:convertDateTime type="both" dateStyle="medium" />
				</h:outputText>
				<h:outputText
					value=" #{global.by} #{nameLookupMB.userName[workitemMB.workitem.item['namCurrentEditor']]}" />

				<!--  Workitem Version History -->
				<a4j:outputPanel layout="block"
					rendered="#{fn:length(workitemMB.versions) gt 1}">
					<h3>
						<h:outputText value="#{messages.version_history}" />
					</h3>

					<rich:dataTable id="minute_versionlist_id" columns="4"
						value="#{workitemMB.versions}" rows="5" var="version">

						<rich:column>
							<f:facet name="header">
								<h:outputText value="#{messages.workitem}" />
							</f:facet>
							<h:outputText value="#{version.item['txtWorkflowSummary']}" />
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="#{global.modified}" />
							</f:facet>
							<h:outputText value="#{version.item['$modified']}">
								<f:convertDateTime timeZone="#{global.timeZone}"
									pattern="#{global.dateTimePattern}" />

							</h:outputText>
							<h:outputText
								value=" #{global.by} #{nameLookupMB.userName[version.item['namCurrentEditor']]}" />
						</rich:column>
						<rich:column>
							<f:facet name="header">
								<h:outputText value="#{global.status}" />
							</f:facet>
							<h:outputText value="#{version.item['txtWorkflowStatus']}" />
						</rich:column>
						<!-- open -->
						<rich:column>
							<a4j:commandLink value="#{global.open}"
								rendered="#{version.item['$uniqueid'] ne workitemMB.workitem.item['$uniqueid']}"
								id="open_version_link_id" actionListener="#{worklistMB.doEdit}"
								action="open_workitem">
							</a4j:commandLink>
						</rich:column>
					</rich:dataTable>
					<rich:datascroller align="left" for="minute_versionlist_id" />
				</a4j:outputPanel>



				<h3>
					<h:outputText value="#{messages.change_history}" />
				</h3>
				<ui:repeat
					value="#{workitemMB.workitem.itemListArray['txtworkflowhistorylog']}"
					var="log">
					<h:outputText value="#{log}" />
					<br />
				</ui:repeat>
			</a4j:outputPanel>
		</a4j:outputPanel>



	</a4j:outputPanel>

</f:subview>
