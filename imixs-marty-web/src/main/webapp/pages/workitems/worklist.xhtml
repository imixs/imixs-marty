<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">

<ui:composition template="/layout/template.xhtml">



	<ui:define name="content">
		<f:view>
			<f:loadBundle basename="bundle.workitem" var="messages" />

			<rich:dragIndicator id="indicator" />

			<h:form id="myprojectsdataForm">

				<div class="sywapp-view sywapp-worklist">
				<!-- *** Header **** -->
				<div class="sywapp-view-header sywapp-worklist-header">
				<!-- *** Header **** -->
				<ui:include src="/pages/workitems/worklist_header.xhtml" />
				</div>

				<div class="sywapp-view-body sywapp-worklist-body">
				
				<a4j:outputPanel id="worklist_id" >
				<a4j:outputPanel layout="block" rendered="#{empty worklistMB.workitems}">
				
					<h:outputText value="#{messages.empty_worklist}"></h:outputText>
				
				</a4j:outputPanel>
				<!-- **** Workitems ***** -->
				<rich:dataList var="workitem"
					value="#{worklistMB.workitems}" rowClasses="sywapp-viewentry">

				<a4j:outputPanel layout="block">
				
				
					<!-- *** Sequence Number *** 
					<a4j:outputPanel layout="block"
						style="float:left;height:34px;border-right:1px solid silver;margin-right:5px;margin-left:2px;margin-bottom:10px;">
						<h:outputText value="#{workitem.item['numSequenceNummer']}"
							style="font-size:30px;font-weight:bold;margin-right:5px;" />
					</a4j:outputPanel>
					-->
					
					<!-- *** Image *** -->
					<a4j:outputPanel layout="block"  rendered="#{!empty workitem.item['txtWorkflowImageURL']}"
						style="float:left;height:30px;margin-right:2px;margin-left:2px;margin-bottom:0px;">
						<img src="#{workitem.item['txtWorkflowImageURL']}"
										style="max-height:24px; margin:4px;" />
					</a4j:outputPanel>
					
					<!-- *** Standard Info *** -->
					<a4j:outputPanel layout="block" style="float:left;">
						<a4j:outputPanel rendered="#{workitem.item['$isAuthor']}">
							<rich:dragSupport dragIndicator=":indicator" dragType="workitem"
								dragValue="#{workitem.item['$uniqueid']}">
								<rich:dndParam name="label"
									value="#{workitem.item['txtWorkflowSummary']}" />
							</rich:dragSupport>
							<h:commandLink actionListener="#{worklistMB.doEdit}"
								action="open_workitem">
								<h:outputText value="#{workitem.item['txtWorkflowSummary']}"
									styleClass="sywapp-viewentry-header" />
								<h:outputText value="#{workitem.item['$modified']}"
									rendered="#{empty workitem.item['txtWorkflowSummary']}"
									styleClass="sywapp-viewentry-header">
									<f:convertDateTime type="both" dateStyle="long" />
								</h:outputText>
							</h:commandLink>
						</a4j:outputPanel>
						<a4j:outputPanel rendered="#{! workitem.item['$isAuthor']}">					
							<h:outputText value="#{workitem.item['txtWorkflowSummary']}"
								styleClass="sywapp-viewentry-header" />
							<h:outputText value="#{workitem.item['$modified']}"
								rendered="#{empty workitem.item['txtWorkflowSummary']}"
								styleClass="sywapp-viewentry-header">
								<f:convertDateTime type="both" dateStyle="medium" />
							</h:outputText>
						</a4j:outputPanel>
						<br />
						<h:outputText style="font-weight: bold;"
							value="#{workitem.item['txtworkflowgroup']}: " />
						<h:outputText value="#{workitem.item['txtworkflowstatus']}" />
						
						<!-- display Project name -->
						<a4j:outputPanel rendered="#{empty projectMB.item['txtname']}">
							<br />
							<h:outputText style="font-weight: bold;" value="#{messages.project}: " />
							<h:outputText value="#{workitem.item['txtProjectName']}" />
						</a4j:outputPanel>
							
						
					</a4j:outputPanel>
				
				<!-- clear floating problem from sidebar in ff and chrome.  -->
				<div style="clear:left;" />

				<!-- Details -->
					<a4j:outputPanel id="infoBlock1" layout="block">
						<a4j:outputPanel layout="block"
							rendered="#{workitem.item['a4j:showDetails']}"
							styleClass="sywapp-viewentry-details">
							<h3><h:outputText value="#{messages.details}" /> <a4j:commandLink
								reRender="infoBlock1,togle_details_command_id"
								actionListener="#{worklistMB.doToggleDetails}"
								value="#{global.close}"
								style="font-size:10px; font-weight:normal;margin-left:10px;text-transform:uppercase;">
							</a4j:commandLink></h3>
							<div class="sywapp-html"><h:outputText
								value="#{workitem.item['txtWorkflowAbstract']}" escape="false" /></div>
						</a4j:outputPanel>
					</a4j:outputPanel>

<!-- History -->
					<a4j:outputPanel id="infoBlock2" layout="block">
						<a4j:outputPanel layout="block"
							rendered="#{workitem.item['a4j:showHistory']}"
							styleClass="sywapp-viewentry-details">
							<h3><h:outputText value="#{messages.history}" /> <a4j:commandLink
								reRender="infoBlock2,togle_history_command_id"
								value="#{global.close}"
								style="font-size:10px; font-weight:normal;margin-left:10px;text-transform:uppercase;"
								actionListener="#{worklistMB.doToggleHistory}">
							</a4j:commandLink></h3>
							<p><h:outputText value="#{global.created}: " /> <h:outputText
								value="#{workitem.item['$created']}">
								<f:convertDateTime type="both" dateStyle="medium" />
							</h:outputText> <h:outputText
								value=" #{global.by} #{nameLookupMB.userName[workitem.item['namcreator']]}" /> <br />
							<h:outputText value="#{global.modified}: " /> <h:outputText
								value="#{workitem.item['$modified']}">
								<f:convertDateTime type="both" dateStyle="medium" />
							</h:outputText> <h:outputText
								value=" #{global.by} #{nameLookupMB.userName[workitem.item['namcurrenteditor']]}" /></p>
							<ui:repeat
								value="#{workitem.itemListArray['txtworkflowhistorylog']}"
								var="log">
								<h:outputText value="#{log}" />
								<br />
							</ui:repeat>
						</a4j:outputPanel>
					</a4j:outputPanel>
				</a4j:outputPanel>
					<ul class="sywapp-viewentry-nav">
 
						<li> <a4j:commandLink
							id="togle_details_command_id"
							value="#{messages.details}"
							reRender="infoBlock1,togle_details_command_id"
							actionListener="#{worklistMB.doToggleDetails}">
						</a4j:commandLink></li>


						<li><a4j:commandLink id="togle_history_command_id"
							value="#{messages.history}"
							reRender="infoBlock2,togle_history_command_id"
							actionListener="#{worklistMB.doToggleHistory}">
						</a4j:commandLink></li>


						<li><h:commandLink rendered="#{workitem.item['$isAuthor']}"
							actionListener="#{worklistMB.doEdit}" action="open_workitem">
							<h:outputText value="#{messages.open_workitem}" />
						</h:commandLink></li>


						<li><h:commandLink rendered="#{workitem.item['$isAuthor']}"
							actionListener="#{worklistMB.doEdit}" action="move_to_project">
							<h:outputText value="#{messages.move}" />
						</h:commandLink></li>

						<!-- Archive -->
						<li><h:commandLink
							rendered="#{(workitem.item['$isAuthor']) and (workitem.item['type'] eq 'workitem')}"
							actionListener="#{worklistMB.doMoveIntoArchive}"
							action="open_worklist">
							<h:outputText value="#{messages.move_to_archive}" />
						</h:commandLink> <h:commandLink
							rendered="#{(workitem.item['$isAuthor']) and (workitem.item['type'] eq 'workitemarchive')}"
							actionListener="#{worklistMB.doRestoreFromArchive}"
							action="open_worklist">
							<h:outputText value="#{messages.restore_from_archive}" />
						</h:commandLink></li>

						<!--  Deletions -->
						<li><h:commandLink
							rendered="#{(workitem.item['$isAuthor']) and (workitem.item['type'] eq 'workitem')}"
							actionListener="#{worklistMB.doMoveIntoDeletions}"
							action="open_worklist">
							<h:outputText value="#{messages.move_to_deletions}" />
						</h:commandLink> <h:commandLink
							rendered="#{(workitem.item['$isAuthor']) and (workitem.item['type'] eq 'workitemdeleted')}"
							actionListener="#{worklistMB.doRestoreFromDeletions}"
							action="open_worklist">
							<h:outputText value="#{messages.restore_from_deletions}" />
						</h:commandLink></li>
					</ul>


				</rich:dataList>
				</a4j:outputPanel>
				</div>


				<div class="sywapp-view-footer sywapp-worklist-footer">


					<h:commandButton actionListener="#{worklistMB.doLoadPrev}"
						disabled="#{worklistMB.row==0}" value="#{global.prev}">
					</h:commandButton>
	
					<h:commandButton actionListener="#{worklistMB.doLoadNext}"
						disabled="#{worklistMB.endOfList}" value="#{global.next}">
					</h:commandButton>
				</div>
				</div>

			</h:form>
		</f:view>
	</ui:define>

</ui:composition>
</html>